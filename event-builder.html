<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Build Event - Crowd</title>
    <link rel="stylesheet" href="event-builder-styles.css">
    <script src="js/config.js"></script>
    <script src="js/auth-utils.js"></script>
    <script src="js/google-places.js"></script>
    <script src="js/good-to-know.js"></script>
    <script src="js/event-builder.js"></script>
    <!-- Google Places API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAiq2Anse5vuEDCI3oKqD2iezo1MfoOiVk&libraries=places&loading=async&callback=initGooglePlaces" async defer></script>
    
    <!-- Fallback initialization for demo without API key -->
    <script>
        // Initialize fallback mode when no API key is available
        window.addEventListener('load', () => {
            setTimeout(() => {
                if (!window.google && window.googlePlaces) {
                    console.log('üó∫Ô∏è Google Places API not loaded - using manual location entry mode');
                    window.googlePlaces.setupManualLocationEntry();
                    
                    // Show location details immediately for manual entry
                    const locationDetails = document.getElementById('locationDetails');
                    if (locationDetails) {
                        locationDetails.style.display = 'block';
                    }
                }
            }, 1000);
        });
    </script>
</head>
<body>
    <div class="builder-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-content">
                <div class="back-link">
                    <a href="dashboard-home.html">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15 18l-6-6 6-6"/>
                        </svg>
                        Back to events
                    </a>
                </div>
                
                <div class="event-summary">
                    <div class="event-image-placeholder"></div>
                    <h2 id="eventTitleSidebar">Event Title</h2>
                    <div class="event-datetime">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                            <line x1="16" x2="16" y1="2" y2="6"/>
                            <line x1="8" x2="8" y1="2" y2="6"/>
                            <line x1="3" x2="21" y1="10" y2="10"/>
                        </svg>
                        <span id="eventDateTimeSidebar">Mon, Sep 1, 2025, 10:00 AM</span>
                    </div>
                    
                    <select class="status-select" id="eventStatus">
                        <option value="draft">Draft</option>
                        <option value="published">Published</option>
                    </select>
                    
                    <a href="#" class="preview-link" onclick="previewEvent()">Preview ‚Üó</a>
                </div>

                <div class="steps-section">
                    <h3>Steps</h3>
                    <div class="step-item active" id="buildStep">
                        <div class="step-icon">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <circle cx="12" cy="12" r="10"/>
                            </svg>
                        </div>
                        <div class="step-content">
                            <h4>Build event page</h4>
                            <p>Add all of your event details and let attendees know what to expect</p>
                        </div>
                    </div>
                    
                    <div class="step-item" id="ticketsStep" onclick="goToTickets()" style="cursor: pointer;">
                        <div class="step-icon">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <circle cx="12" cy="12" r="10"/>
                            </svg>
                        </div>
                        <div class="step-content">
                            <h4>Add tickets</h4>
                            <p>Use our suggestions to help sell more tickets or manually create your own</p>
                        </div>
                    </div>
                    
                    <div class="step-item" id="publishStep" onclick="goToPublish()" style="cursor: pointer;">
                        <div class="step-icon">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <circle cx="12" cy="12" r="10"/>
                            </svg>
                        </div>
                        <div class="step-content">
                            <h4>Publish</h4>
                            <p>Review your event page and settings, then publish your event</p>
                        </div>
                    </div>
                </div>

                <div class="dashboard-section">
                    <div class="dashboard-toggle">
                        <span>Dashboard</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M7 10l5 5 5-5z"/>
                        </svg>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-content">
                    <div class="logo">
                        <img src="logo.jpg" alt="Event Platform" class="logo-img" style="height: 40px; width: auto;">
                    </div>
                    <div class="header-right">
                        <div class="user-menu" onclick="toggleUserDropdown()">
                            <div class="user-avatar" id="userAvatar">U</div>
                            <span class="user-name" id="userName">User</span>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M7 10l5 5 5-5z"/>
                            </svg>
                            <div class="user-dropdown" id="userDropdown" style="display: none;">
                                <a href="#" onclick="viewProfile()">View Profile</a>
                                <a href="#" onclick="accountSettings()">Account Settings</a>
                                <div class="dropdown-divider"></div>
                                <a href="#" onclick="logoutUser()">Logout</a>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <div class="content-area" id="contentArea">
                <!-- Build Event Page Content -->
                <div class="build-content" id="buildContent">
                    <div class="content-header">
                        <p class="content-subtitle">A short and sweet sentence about your event.</p>
                    </div>
                    
                    <div class="main-form">
                        <!-- Event Media Upload Section -->
                        <div class="media-upload-section">
                            <div class="section-header">
                                <h3>Add images and video</h3>
                                <div class="add-button">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="#3b82f6">
                                        <line x1="12" x2="12" y1="5" y2="19"/>
                                        <line x1="5" x2="19" y1="12" y2="12"/>
                                    </svg>
                                </div>
                            </div>

                            <!-- Images Section -->
                            <div class="media-subsection">
                                <h4>Images</h4>
                                <div class="pro-tip">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="#3b82f6">
                                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                    </svg>
                                    <span><strong>Pro tip:</strong> Use photos that set the mood, and avoid distracting text overlays. <a href="#">View examples ‚Üí</a></span>
                                </div>
                                <div class="image-upload-area" onclick="uploadImage()">
                                    <div class="upload-placeholder" id="uploadPlaceholder">
                                        <div class="upload-icon">
                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="#ccc">
                                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                                <circle cx="8.5" cy="8.5" r="1.5"/>
                                                <polyline points="21,15 16,10 5,21"/>
                                            </svg>
                                        </div>
                                        <p>Drag and drop an image or</p>
                                        <button type="button" class="upload-btn">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                                <polyline points="7,10 12,15 17,10"/>
                                                <line x1="12" x2="12" y1="15" y2="3"/>
                                            </svg>
                                            Upload Image
                                        </button>
                                    </div>
                                    <img id="eventImage" style="display: none; width: 100%; height: 100%; object-fit: cover; border-radius: 8px;">
                                </div>
                                <div class="upload-specs">
                                    <span>‚Ä¢ Recommended image size: 2160 x 1080px</span>
                                    <span>‚Ä¢ Maximum file size: 10MB</span>
                                    <span>‚Ä¢ Supported image files: JPEG, PNG</span>
                                </div>
                            </div>

                            <!-- Video Section -->
                            <div class="media-subsection">
                                <h4>Video</h4>
                                <p class="video-description">Add a video to show your event's vibe. The video will appear with your event images.</p>
                                <div class="video-upload-area" onclick="uploadVideo()">
                                    <div class="upload-placeholder" id="videoUploadPlaceholder">
                                        <div class="upload-icon">
                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="#ccc">
                                                <polygon points="23 7 16 12 23 17 23 7"/>
                                                <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
                                            </svg>
                                        </div>
                                        <p>Drag and drop an image or</p>
                                        <button type="button" class="upload-btn">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                                <polygon points="23 7 16 12 23 17 23 7"/>
                                                <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
                                            </svg>
                                            Upload video
                                        </button>
                                    </div>
                                </div>
                                <div class="upload-specs">
                                    <span>‚Ä¢ Min resolution: 480p</span>
                                    <span>‚Ä¢ Ratio: any vertical</span>
                                    <span>‚Ä¢ Length: up to 1 min</span>
                                    <span>‚Ä¢ Formats: MP4, MOV</span>
                                    <span><a href="#">View more details ‚Üí</a></span>
                                </div>
                            </div>
                        </div>

                        <!-- Event Title -->
                        <div class="title-section">
                            <div class="add-button">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="#3b82f6">
                                    <line x1="12" x2="12" y1="5" y2="19"/>
                                    <line x1="5" x2="19" y1="12" y2="12"/>
                                </svg>
                            </div>
                            <h1 contenteditable="true" class="event-title" id="eventTitle" data-placeholder="Enter event title">Event Title</h1>
                        </div>

                        <!-- Date and Time / Location Section -->
                        <div class="details-grid">
                            <div class="details-section">
                                <div class="section-header">
                                    <h3>Date and time</h3>
                                    <div class="add-button">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="#3b82f6">
                                            <line x1="12" x2="12" y1="5" y2="19"/>
                                            <line x1="5" x2="19" y1="12" y2="12"/>
                                        </svg>
                                    </div>
                                </div>
                                
                                <!-- Date and Time Inputs -->
                                <div class="datetime-inputs">
                                    <div class="input-group">
                                        <label for="eventDate">Date</label>
                                        <input type="date" id="eventDate" class="date-input">
                                    </div>
                                    <div class="input-group">
                                        <label for="startTime">Start Time</label>
                                        <input type="time" id="startTime" class="time-input">
                                    </div>
                                    <div class="input-group">
                                        <label for="endTime">End Time</label>
                                        <input type="time" id="endTime" class="time-input">
                                    </div>
                                </div>
                            </div>

                            <div class="details-section">
                                <div class="section-header">
                                    <h3>Location</h3>
                                    <div class="add-button">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="#3b82f6">
                                            <line x1="12" x2="12" y1="5" y2="19"/>
                                            <line x1="5" x2="19" y1="12" y2="12"/>
                                        </svg>
                                    </div>
                                </div>
                                <div class="location-display">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                        <circle cx="12" cy="10" r="3"/>
                                    </svg>
                                    <div class="location-text">
                                        <input type="text" class="location-input" id="locationInput" placeholder="Search for a venue or address">
                                    </div>
                                </div>
                                <div class="location-details" id="locationDetails" style="display: none; margin-top: 12px;">
                                    <div class="location-components">
                                        <div class="input-group">
                                            <label for="venueName">Venue Name</label>
                                            <input type="text" id="venueName" class="venue-input" placeholder="Venue name">
                                        </div>
                                        <div class="input-group">
                                            <label for="streetAddress">Street Address</label>
                                            <input type="text" id="streetAddress" class="address-input" placeholder="Street address">
                                        </div>
                                        <div class="input-row">
                                            <div class="input-group">
                                                <label for="cityName">City</label>
                                                <input type="text" id="cityName" class="city-input" placeholder="City">
                                            </div>
                                            <div class="input-group">
                                                <label for="stateName">State</label>
                                                <input type="text" id="stateName" class="state-input" placeholder="State">
                                            </div>
                                            <div class="input-group">
                                                <label for="zipCode">ZIP Code</label>
                                                <input type="text" id="zipCode" class="zip-input" placeholder="ZIP">
                                            </div>
                                        </div>
                                        <div class="input-group">
                                            <label for="countryName">Country</label>
                                            <input type="text" id="countryName" class="country-input" placeholder="Country" value="United States">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- Overview Section -->
                        <div class="overview-section">
                            <div class="section-header">
                                <h3>Overview</h3>
                                <div class="add-button">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="#3b82f6">
                                        <line x1="12" x2="12" y1="5" y2="19"/>
                                        <line x1="5" x2="19" y1="12" y2="12"/>
                                    </svg>
                                </div>
                            </div>
                            <textarea class="overview-description" id="overviewDescription" placeholder="Use this section to provide more details about your event. You can include things to know, venue information, accessibility options‚Äîanything that will help people know what to expect."></textarea>
                        </div>

                        <!-- Good to Know Section -->
                        <div class="good-to-know-section">
                            <div class="section-header">
                                <h3>Good to know</h3>
                                <div class="add-button">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="#3b82f6">
                                        <line x1="12" x2="12" y1="5" y2="19"/>
                                        <line x1="5" x2="19" y1="12" y2="12"/>
                                    </svg>
                                </div>
                            </div>
                            
                            <div class="highlights-section">
                                <h4>Highlights</h4>
                                <div class="highlight-buttons">
                                    <button class="highlight-btn" onclick="addHighlight('age')">+ Add Age info</button>
                                    <button class="highlight-btn" onclick="addHighlight('door')">+ Add Door Time</button>
                                    <button class="highlight-btn" onclick="addHighlight('parking')">+ Add Parking info</button>
                                    <button class="highlight-btn" onclick="addHighlight('dresscode')">+ Add Dress Code</button>
                                    <button class="highlight-btn" onclick="addHighlight('accessibility')">+ Add Accessibility</button>
                                    <button class="highlight-btn" onclick="addHighlight('food')">+ Add Food & Drinks</button>
                                </div>
                                <div class="highlights-container" id="highlightsContainer">
                                    <!-- Dynamic highlights will be added here -->
                                </div>
                            </div>
                            
                            <div class="faq-section">
                                <h4>Frequently asked questions</h4>
                                <div class="faq-tip">
                                    <span class="tip-icon">üí°</span>
                                    <span>Events with FAQs have 8% more organic traffic</span>
                                </div>
                                <div class="faq-container" id="faqContainer">
                                    <!-- Dynamic FAQs will be added here -->
                                </div>
                                <button class="add-question-btn" onclick="addFAQ()">+ Add question</button>
                            </div>
                        </div>

                        <!-- Add More Sections -->
                        <div class="more-sections-area">
                            <div class="more-sections-header">
                                <h3>Add more sections to your event page</h3>
                                <p>Make your event stand out even more. These sections help attendees find information and answer their questions - which means more ticket sales and less time answering messages.</p>
                            </div>

                            <div class="sections-grid">
                                <!-- Lineup Section -->
                                <div class="section-card" id="lineupCard">
                                    <div class="section-icon">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="#374151">
                                            <path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                                        </svg>
                                    </div>
                                    <div class="section-info">
                                        <h4>Lineup <span class="new-badge">New</span></h4>
                                        <a href="#" class="see-examples">See examples</a>
                                    </div>
                                    <button class="add-section-btn" onclick="addLineupSection()">Add</button>
                                </div>

                                <!-- Agenda Section -->
                                <div class="section-card" id="agendaCard">
                                    <div class="section-icon">
                                        <svg width="24" height="24" viewBox="0 0 24 24" fill="#374151">
                                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                            <line x1="16" x2="16" y1="2" y2="6"/>
                                            <line x1="8" x2="8" y1="2" y2="6"/>
                                            <line x1="3" x2="21" y1="10" y2="10"/>
                                        </svg>
                                    </div>
                                    <div class="section-info">
                                        <h4>Agenda</h4>
                                        <a href="#" class="see-examples">See examples</a>
                                    </div>
                                    <button class="add-section-btn" onclick="addAgendaSection()">Add</button>
                                </div>
                            </div>
                        </div>

                        <!-- Lineup Section (Initially Hidden) -->
                        <div class="lineup-section" id="lineupSection" style="display: none;">
                            <div class="section-header">
                                <h3>Lineup <button class="edit-btn" onclick="editLineupTitle()">‚úèÔ∏è</button></h3>
                                <button class="delete-section-btn" onclick="deleteLineupSection()">Delete section</button>
                            </div>
                            <p class="section-description">Highlight your lineup of special guests with a section on your event page. Change the title of this section to fit your event's theme and add info about each person. You can set someone as a headliner to highlight them even more.</p>

                            <div class="lineup-container" id="lineupContainer">
                                <div class="lineup-item">
                                    <div class="lineup-image">
                                        <div class="image-upload-placeholder">
                                            <span>Upload an image*</span>
                                            <small>Image should be at least<br>320x320 pixels</small>
                                            <button class="upload-btn-small" onclick="uploadLineupImage()">Upload</button>
                                        </div>
                                    </div>
                                    <div class="lineup-details">
                                        <input type="text" placeholder="Name" class="lineup-name">
                                        <div class="tagline-section">
                                            <button class="add-tagline-btn" onclick="addTagline()">üè∑Ô∏è Add a tagline</button>
                                        </div>
                                        <textarea placeholder="Description" class="lineup-description"></textarea>
                                        <div class="character-count">0 / 5000</div>
                                        <div class="lineup-options">
                                            <label class="headliner-toggle">
                                                <input type="checkbox"> Set as headliner
                                            </label>
                                            <button class="social-links-btn" onclick="addSocialLinks()">üîó Add social links</button>
                                        </div>
                                    </div>
                                    <button class="delete-lineup-btn" onclick="deleteLineupItem(this)">üóëÔ∏è</button>
                                </div>
                            </div>
                            <button class="add-another-btn" onclick="addAnotherLineupItem()">+ Add another</button>
                        </div>

                        <!-- Agenda Section (Initially Hidden) -->
                        <div class="agenda-section" id="agendaSection" style="display: none;">
                            <div class="section-header">
                                <h3>Agenda</h3>
                                <button class="delete-section-btn" onclick="deleteAgendaSection()">Delete section</button>
                            </div>
                            <p class="section-description">Add an itinerary, schedule, or lineup to your event. You can include a time, a description of what will happen, and who will host or perform during the event. (Ex. Speaker, performer, artist, guide, etc.) If your event has multiple dates, you can add a second agenda.</p>

                            <div class="agenda-tabs">
                                <button class="agenda-tab active" onclick="switchAgendaTab('agenda')">Agenda</button>
                                <button class="agenda-tab" onclick="switchAgendaTab('new')">+ Add new agenda</button>
                            </div>

                            <div class="agenda-container" id="agendaContainer">
                                <div class="agenda-item">
                                    <input type="text" placeholder="Title*" class="agenda-title">
                                    <div class="agenda-time-section">
                                        <div class="time-input-group">
                                            <label>üïê Start time</label>
                                            <input type="time" class="agenda-start-time">
                                        </div>
                                        <div class="time-input-group">
                                            <label>üïê End time</label>
                                            <input type="time" class="agenda-end-time">
                                        </div>
                                    </div>
                                    <div class="agenda-optional-fields">
                                        <button class="add-host-btn" onclick="addHost()">üë§ Host or Artist</button>
                                        <button class="add-description-btn" onclick="addAgendaDescription()">üìù Add description</button>
                                    </div>
                                    <button class="delete-agenda-btn" onclick="deleteAgendaItem(this)">üóëÔ∏è</button>
                                </div>
                            </div>
                            <button class="add-slot-btn" onclick="addAgendaSlot()">+ Add slot</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Save Button -->
            <div class="save-section">
                <button class="save-btn" onclick="saveAndContinue()">Save and continue</button>
            </div>
        </main>
    </div>

    <!-- Hidden file inputs -->
    <input type="file" id="imageInput" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
    <input type="file" id="videoInput" accept="video/*" style="display: none;" onchange="handleVideoUpload(event)">
    <input type="file" id="lineupImageInput" accept="image/*" style="display: none;" onchange="handleLineupImageUpload(event)">

    <!-- The JavaScript is now in js/event-builder.js -->
</body>
</html>
